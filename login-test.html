<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 500px;
            margin: 50px auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 1.8rem;
            font-weight: 500;
        }
        
        .form-container {
            padding: 40px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .test-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .test-info h3 {
            margin: 0 0 10px 0;
            color: #1976d2;
        }
        
        .test-info p {
            margin: 5px 0;
            color: #424242;
            font-size: 14px;
        }
        
        .debug-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .debug-panel h4 {
            margin: 0 0 10px 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîê –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</h1>
        </div>
        
        <div class="form-container">
            <div class="test-info">
                <h3>üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∞</h3>
                <p><strong>Email:</strong> barbarosgroup2024@gmail.com</p>
                <p><strong>–ü–∞—Ä–æ–ª—å:</strong> –ª—é–±–æ–π (–Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è)</p>
                <p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</p>
            </div>
            
            <!-- –§–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–∏–º–∏—Ç–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º—É –¢–∏–ª—å–¥—ã) -->
            <form class="t-form js-form-proccess" id="loginForm">
                <div class="form-group">
                    <label for="email">üìß Email</label>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email"
                        value="barbarosgroup2024@gmail.com"
                        required
                    >
                </div>
                
                <div class="form-group">
                    <label for="password">üîí –ü–∞—Ä–æ–ª—å</label>
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
                        value="test123"
                    >
                </div>
                
                <button type="submit" class="btn" id="submitBtn">
                    üöÄ –í–æ–π—Ç–∏ –≤ –∫–∞–±–∏–Ω–µ—Ç
                </button>
            </form>
            
            <div class="debug-panel" id="debugPanel">
                <h4>üîç –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                <div id="debugContent">–û–∂–∏–¥–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π...</div>
            </div>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ -->
    <script>
        /**
         * üöÄ –°–ö–†–ò–ü–¢ –î–õ–Ø –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –§–û–†–ú–´ –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò –¢–ò–õ–¨–î–´
         */

        (function() {
            'use strict';
            
            // ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò
            const CONFIG = {
                // URL –≤–∞—à–µ–≥–æ –±—ç–∫–µ–Ω–¥–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–π –¥–ª—è —Ç–µ—Å—Ç–∞)
                BACKEND_URL: 'http://localhost:3000',
                
                // –°–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ñ–æ—Ä–º—ã (–¢–∏–ª—å–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –∫–ª–∞—Å—Å—ã)
                FORM_SELECTORS: [
                    'form[data-form-type="login"]',
                    'form.js-form-proccess',
                    'form[action*="forms.tildacdn.com"]',
                    'form.t-form',
                    'form'
                ],
                
                // –°–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø–æ–ª–µ–π email –∏ password
                EMAIL_SELECTORS: [
                    'input[name="email"]',
                    'input[type="email"]',
                    'input[name="Email"]',
                    'input[placeholder*="mail"]',
                    'input[placeholder*="–ø–æ—á—Ç"]'
                ],
                
                PASSWORD_SELECTORS: [
                    'input[name="password"]',
                    'input[type="password"]',
                    'input[name="Password"]',
                    'input[placeholder*="–ø–∞—Ä–æ–ª—å"]',
                    'input[placeholder*="Password"]'
                ],
                
                // –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö)
                TIMEOUT: 10000,
                
                // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
                DEBUG: true
            };
            
            // üìù –§–£–ù–ö–¶–ò–Ø –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø
            function log(message, data = null) {
                if (CONFIG.DEBUG) {
                    console.log(`[Tilda Auth] ${message}`, data || '');
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤ debug –ø–∞–Ω–µ–ª—å
                    const debugContent = document.getElementById('debugContent');
                    if (debugContent) {
                        const timestamp = new Date().toLocaleTimeString();
                        debugContent.innerHTML += `<div>[${timestamp}] ${message}</div>`;
                        debugContent.scrollTop = debugContent.scrollHeight;
                    }
                }
            }
            
            // üîç –ü–û–ò–°–ö –≠–õ–ï–ú–ï–ù–¢–ê –ü–û –ù–ï–°–ö–û–õ–¨–ö–ò–ú –°–ï–õ–ï–ö–¢–û–†–ê–ú
            function findElement(selectors) {
                for (const selector of selectors) {
                    const element = document.querySelector(selector);
                    if (element) {
                        log(`–ù–∞–π–¥–µ–Ω —ç–ª–µ–º–µ–Ω—Ç –ø–æ —Å–µ–ª–µ–∫—Ç–æ—Ä—É: ${selector}`);
                        return element;
                    }
                }
                return null;
            }
            
            // üìß –û–¢–ü–†–ê–í–ö–ê –î–ê–ù–ù–´–• –ù–ê –°–ï–†–í–ï–†
            async function sendLoginRequest(email, password) {
                try {
                    log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏', { email, password: '***' });
                    
                    const response = await fetch(`${CONFIG.BACKEND_URL}/api/login`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ email, password })
                    });
                    
                    const result = await response.json();
                    log('–ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞', result);
                    
                    return { success: response.ok, data: result };
                    
                } catch (error) {
                    log('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞', error);
                    return { 
                        success: false, 
                        data: { 
                            status: 'error', 
                            message: '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É' 
                        } 
                    };
                }
            }
            
            // üé® –ü–û–ö–ê–ó –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Æ
            function showNotification(message, type = 'info') {
                // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                const existingNotifications = document.querySelectorAll('.tilda-auth-notification');
                existingNotifications.forEach(n => n.remove());
                
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                const notification = document.createElement('div');
                notification.className = 'tilda-auth-notification';
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    z-index: 10000;
                    padding: 15px 20px;
                    border-radius: 8px;
                    color: white;
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                    font-size: 14px;
                    font-weight: 500;
                    max-width: 350px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    animation: slideIn 0.3s ease-out;
                    ${type === 'success' ? 'background: linear-gradient(135deg, #28a745, #20c997);' : ''}
                    ${type === 'error' ? 'background: linear-gradient(135deg, #dc3545, #e74c3c);' : ''}
                    ${type === 'info' ? 'background: linear-gradient(135deg, #007bff, #6610f2);' : ''}
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
                if (!document.querySelector('#tilda-auth-styles')) {
                    const styles = document.createElement('style');
                    styles.id = 'tilda-auth-styles';
                    styles.textContent = `
                        @keyframes slideIn {
                            from { transform: translateX(100%); opacity: 0; }
                            to { transform: translateX(0); opacity: 1; }
                        }
                        @keyframes slideOut {
                            from { transform: translateX(0); opacity: 1; }
                            to { transform: translateX(100%); opacity: 0; }
                        }
                    `;
                    document.head.appendChild(styles);
                }
                
                notification.textContent = message;
                document.body.appendChild(notification);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease-in';
                    setTimeout(() => notification.remove(), 300);
                }, 5000);
            }
            
            // üîÑ –ü–ï–†–ï–ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï –ù–ê –°–¢–†–ê–ù–ò–¶–£ –ö–ê–ë–ò–ù–ï–¢–ê
            function redirectToCabinet(token) {
                const cabinetUrl = `${CONFIG.BACKEND_URL}/cabinet?token=${token}`;
                log('–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ –∫–∞–±–∏–Ω–µ—Ç', cabinetUrl);
                
                showNotification('‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º...', 'success');
                
                setTimeout(() => {
                    window.location.href = cabinetUrl;
                }, 1500);
            }
            
            // üìã –û–ë–†–ê–ë–û–¢–ö–ê –û–¢–ü–†–ê–í–ö–ò –§–û–†–ú–´
            function handleFormSubmit(event, form) {
                event.preventDefault();
                log('–ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã');
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏
                const submitBtn = document.getElementById('submitBtn');
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.textContent = '‚è≥ –ü—Ä–æ–≤–µ—Ä—è–µ–º...';
                }
                
                // –ù–∞—Ö–æ–¥–∏–º –ø–æ–ª—è email –∏ password
                const emailField = findElement(CONFIG.EMAIL_SELECTORS);
                const passwordField = findElement(CONFIG.PASSWORD_SELECTORS);
                
                if (!emailField) {
                    log('–ü–æ–ª–µ email –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
                    showNotification('‚ùå –ü–æ–ª–µ email –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∞ —Ñ–æ—Ä–º–µ', 'error');
                    return;
                }
                
                const email = emailField.value.trim();
                const password = passwordField ? passwordField.value : '';
                
                if (!email) {
                    showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ email', 'error');
                    emailField.focus();
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = 'üöÄ –í–æ–π—Ç–∏ –≤ –∫–∞–±–∏–Ω–µ—Ç';
                    }
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç email
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email', 'error');
                    emailField.focus();
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = 'üöÄ –í–æ–π—Ç–∏ –≤ –∫–∞–±–∏–Ω–µ—Ç';
                    }
                    return;
                }
                
                log('–î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –≤–∞–ª–∏–¥–Ω—ã', { email, hasPassword: !!password });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                showNotification('üîÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ...', 'info');
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                sendLoginRequest(email, password)
                    .then(response => {
                        if (response.success && response.data.status === 'success') {
                            log('–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞', response.data);
                            
                            if (response.data.token) {
                                redirectToCabinet(response.data.token);
                            } else {
                                showNotification('‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!', 'success');
                            }
                        } else {
                            log('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏', response.data);
                            const errorMessage = response.data.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
                            showNotification(`‚ùå ${errorMessage}`, 'error');
                        }
                    })
                    .catch(error => {
                        log('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞', error);
                        showNotification('‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.', 'error');
                    })
                    .finally(() => {
                        // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
                        if (submitBtn) {
                            submitBtn.disabled = false;
                            submitBtn.textContent = 'üöÄ –í–æ–π—Ç–∏ –≤ –∫–∞–±–∏–Ω–µ—Ç';
                        }
                    });
            }
            
            // üéØ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–ö–†–ò–ü–¢–ê
            function initializeScript() {
                log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
                
                // –ò—â–µ–º —Ñ–æ—Ä–º—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                const form = findElement(CONFIG.FORM_SELECTORS);
                
                if (!form) {
                    log('–§–æ—Ä–º–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ');
                    return;
                }
                
                log('–§–æ—Ä–º–∞ –Ω–∞–π–¥–µ–Ω–∞', form);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
                form.addEventListener('submit', (event) => {
                    handleFormSubmit(event, form);
                });
                
                log('–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–æ–≥–æ, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
                if (CONFIG.DEBUG) {
                    showNotification('üîó –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–∫—Ç–∏–≤–µ–Ω', 'info');
                }
            }
            
            // üöÄ –ó–ê–ü–£–°–ö –°–ö–†–ò–ü–¢–ê
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initializeScript);
            } else {
                initializeScript();
            }
            
            log('–°–∫—Ä–∏–ø—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¢–∏–ª—å–¥–æ–π –∑–∞–≥—Ä—É–∂–µ–Ω');
            
        })();
    </script>
</body>
</html>